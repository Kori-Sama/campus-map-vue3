<template>
    <div v-if="show" class="gym-modal-overlay" @click="closeModal">
        <div class="gym-modal" @click.stop>
            <button class="modal-close" @click="closeModal">âœ•</button>

            <div class="modal-header">
                <h2>ğŸŸï¸ è¥¿å—äº¤é€šå¤§å­¦ä½“è‚²é¦†</h2>
                <div class="tab-container">
                    <div class="tab-item" :class="{ active: activeTab === 'rules' }" @click="handleTabSwitch('rules')">
                        ä½“è‚²é¦†ä½¿ç”¨è§„åˆ™
                    </div>
                    <div class="tab-item" :class="{ active: activeTab === 'data' }" @click="handleTabSwitch('data')">
                        æ•°æ®å¯è§†åŒ–å¤§å±
                    </div>
                </div>
            </div>

            <div class="modal-body">
                <!-- ä½¿ç”¨è§„åˆ™ -->
                <div v-if="activeTab === 'rules'">
                    <div class="info-section">
                        <h3>åŸºæœ¬ä¿¡æ¯</h3>
                        <div class="info-item">
                            <span class="label">ğŸ“ ä½ç½®ï¼š</span>
                            <span>æ ¡å›­ä¸œå—åŒºï¼ˆè¿‘æ“åœºï¼Œä»ä¸œé—¨æ­¥è¡Œçº¦10åˆ†é’Ÿï¼‰</span>
                        </div>
                        <div class="info-item">
                            <span class="label">â° å¼€æ”¾æ—¶é—´ï¼š</span>
                            <span>å‘¨ä¸€è‡³å‘¨æ—¥ 6:00-22:00ï¼ˆèŠ‚å‡æ—¥æ­£å¸¸å¼€æ”¾ï¼‰</span>
                        </div>
                        <div class="info-item">
                            <span class="label">ğŸ“ è”ç³»ç”µè¯ï¼š</span>
                            <span>æœåŠ¡å° 028-66368888 | åœºåœ°é¢„çº¦ 028-66368899</span>
                        </div>
                    </div>

                    <div class="info-section">
                        <h3>ä½¿ç”¨è§„åˆ™</h3>
                        <ul class="facilities-list">
                            <li>ğŸ€ åœºåœ°é¢„çº¦ï¼šé€šè¿‡"æ™ºæ…§ä½“è‚²"APPé¢„çº¦ï¼Œæå‰1-7å¤©ï¼Œå•æ¬¡æœ€é•¿2å°æ—¶</li>
                            <li>ğŸ‘• ç€è£…è¦æ±‚ï¼šå¿…é¡»ç©¿è¿åŠ¨æœã€è¿åŠ¨é‹ï¼Œç¦æ­¢ç©¿æ‹–é‹ã€çš®é‹å…¥åœº</li>
                            <li>ğŸ« å…¥åœºæ–¹å¼ï¼šåˆ·æ ¡å›­å¡æˆ–æ‰«ç å…¥åœºï¼Œéæœ¬æ ¡äººå‘˜éœ€ç™»è®°å¹¶ç¼´çº³åœºåœ°è´¹</li>
                            <li>âš ï¸ å®‰å…¨è§„èŒƒï¼šç¦æ­¢æºå¸¦ç»ç’ƒå™¨çš¿ã€å±é™©ç‰©å“ï¼Œä½¿ç”¨å™¨æ¢°éœ€éµå®ˆå®‰å…¨è¯´æ˜</li>
                            <li>ğŸ§¹ æ–‡æ˜ä½¿ç”¨ï¼šè¿åŠ¨åå½’è¿˜å™¨æï¼Œä¿æŒåœºåœ°æ•´æ´ï¼Œç¦æ­¢å¸çƒŸã€å¤§å£°å–§å“—</li>
                        </ul>
                    </div>

                    <div class="info-section">
                        <h3>åœºé¦†è®¾æ–½</h3>
                        <ul class="facilities-list">
                            <li>ğŸ€ ç¯®çƒé¦†ï¼š2å±‚ï¼Œ4ç‰‡æ ‡å‡†åœºåœ°ï¼Œé…å¤‡LEDè®°åˆ†æ¿å’Œä¸“ä¸šåœ°æ¿</li>
                            <li>ğŸ‹ï¸ å¥èº«æˆ¿ï¼š1å±‚ï¼Œ150+å°å™¨æ¢°ï¼Œå«åŠ›é‡åŒºã€æœ‰æ°§åŒºã€è‡ªç”±é‡é‡åŒº</li>
                            <li>ğŸŠ æ¸¸æ³³é¦†ï¼šåœ°ä¸‹1å±‚ï¼Œ50ç±³æ ‡å‡†æ³³æ± ï¼Œæ’æ¸©28â„ƒï¼Œé…æ•‘ç”Ÿå‘˜</li>
                            <li>âš½ è¶³çƒåœºï¼šå®¤å¤–å¤©ç„¶è‰åªï¼Œå¯æ‰¿åŠæ ¡çº§æ¯”èµ›ï¼Œé…æ›´è¡£å®¤</li>
                            <li>ğŸ¾ ç¾½æ¯›çƒé¦†ï¼š1å±‚ï¼Œ12ç‰‡åœºåœ°ï¼Œæ™ºèƒ½ç…§æ˜ç³»ç»Ÿï¼Œå¯çº¿ä¸Šé¢„çº¦</li>
                            <li>ğŸ“ ä¹’ä¹“çƒé¦†ï¼š2å±‚ï¼Œ20å¼ çƒå°ï¼Œæä¾›çƒæ‹ç§ŸèµæœåŠ¡</li>
                        </ul>
                    </div>

                    <div class="info-section">
                        <h3>äº¤é€šæŒ‡å¼•</h3>
                        <p>
                            æ ¡å†…è·¯çº¿ï¼šä»æ ¡å¤§é—¨æ­¥è¡Œçº¦20åˆ†é’Ÿï¼›ä¹˜åæ ¡å†…æ‘†æ¸¡è½¦ï¼ˆ2å·çº¿ï¼‰è‡³ã€Œä½“è‚²ä¸­å¿ƒç«™ã€ä¸‹è½¦ï¼›å„å®¿èˆæ¥¼è‡³ä½“è‚²é¦†å‡æœ‰æŒ‡ç¤ºç‰Œã€‚<br>
                            æ ¡å¤–è·¯çº¿ï¼šåœ°é“2å·çº¿ã€Œäº¤å¤§ç«™ã€Cå£å‡ºï¼Œæ­¥è¡Œ15åˆ†é’Ÿè‡³æ ¡å›­å—é—¨ï¼Œè¿›å…¥åæ²¿ä¸»å¹²é“å‰è¡Œ600ç±³ï¼›è‡ªé©¾å¯åœè‡³ä½“è‚²é¦†ä¸“ç”¨åœè½¦åœºï¼ˆå‰2å°æ—¶å…è´¹ï¼‰ã€‚
                        </p>
                    </div>
                </div>

                <!-- å¤§å±æ•°æ®å¯è§†åŒ– -->
                <div v-if="activeTab === 'data'" class="data-visual-section">
                    <div class="data-cards">
                        <div class="data-card">
                            <div class="data-title">ä»Šæ—¥è¿åŠ¨äººæ•°</div>
                            <div class="data-value">{{ todayVisitors }}</div>
                            <div class="data-trend up">â†‘15% è¾ƒæ˜¨æ—¥</div>
                        </div>
                        <div class="data-card">
                            <div class="data-title">å½“å‰åœ¨åœºäººæ•°</div>
                            <div class="data-value">{{ currentVisitors }}</div>
                            <div class="data-trend down">â†“3% è¾ƒä¸Šå°æ—¶</div>
                        </div>
                        <div class="data-card">
                            <div class="data-title">ä»Šæ—¥é¢„çº¦åœºæ¬¡</div>
                            <div class="data-value">{{ todayBookings }}</div>
                            <div class="data-trend up">â†‘20% è¾ƒæ˜¨æ—¥</div>
                        </div>
                        <div class="data-card">
                            <div class="data-title">åœºåœ°ä½¿ç”¨ç‡</div>
                            <div class="data-value">{{ fieldUsage }}%</div>
                            <div class="data-trend up">â†‘18% è¾ƒä¸Šå‘¨</div>
                        </div>
                    </div>

                    <div class="chart-tabs">
                        <button class="chart-tab-btn" :class="{ active: currentChart === 'line' }"
                            @click="switchChart('line')">
                            ğŸ“ˆ åœºåœ°ä½¿ç”¨ç‡
                        </button>
                        <button class="chart-tab-btn" :class="{ active: currentChart === 'pie' }"
                            @click="switchChart('pie')">
                            ğŸ… è¿åŠ¨é¡¹ç›®åˆ†å¸ƒ
                        </button>
                        <button class="chart-tab-btn" :class="{ active: currentChart === 'bar' }"
                            @click="switchChart('bar')">
                            â° è¿åŠ¨é«˜å³°æ—¶æ®µ
                        </button>
                        <button class="chart-tab-btn" :class="{ active: currentChart === 'wordCloud' }"
                            @click="switchChart('wordCloud')">
                            â˜ï¸ çƒ­é—¨è¿åŠ¨é¡¹ç›®
                        </button>
                    </div>

                    <div class="charts-container">
                        <div v-show="currentChart === 'line'" class="chart-item">
                            <h4>ğŸ“ˆ è¿‘7å¤©åœºåœ°ä½¿ç”¨ç‡è¶‹åŠ¿</h4>
                            <div ref="lineChart" class="chart-canvas"></div>
                        </div>
                        <div v-show="currentChart === 'pie'" class="chart-item">
                            <h4>ğŸ… è¿åŠ¨é¡¹ç›®å‚ä¸å æ¯”</h4>
                            <div ref="pieChart" class="chart-canvas"></div>
                        </div>
                        <div v-show="currentChart === 'bar'" class="chart-item">
                            <h4>â° æ¯æ—¥è¿åŠ¨é«˜å³°æ—¶æ®µ</h4>
                            <div ref="barChart" class="chart-canvas"></div>
                        </div>
                        <div v-show="currentChart === 'wordCloud'" class="chart-item">
                            <h4>â˜ï¸ çƒ­é—¨è¿åŠ¨é¡¹ç›®å…³é”®è¯</h4>
                            <div ref="wordCloudChart" class="chart-canvas"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn btn-secondary" @click="closeModal">å…³é—­</button>
                <button class="btn btn-primary" @click="navigateToGym">ğŸ—ºï¸ å¯¼èˆªåˆ°æ­¤</button>
                <button class="btn btn-info" @click="openFullScreenData" v-if="activeTab === 'data'">
                    ğŸ“Š æŸ¥çœ‹å®Œæ•´å¤§å±
                </button>
            </div>
        </div>
    </div>
</template>

<script setup>
import { ref, watch, nextTick, getCurrentInstance } from 'vue';

const props = defineProps({
    show: Boolean
});
const emit = defineEmits(['close', 'navigate', 'open-full-screen-data']);

const activeTab = ref('rules');
const currentChart = ref('line');

// æ¨¡æ‹Ÿæ•°æ®
const todayVisitors = ref(1520);
const currentVisitors = ref(680);
const todayBookings = ref(142);
const fieldUsage = ref(82);

const lineChart = ref(null);
const pieChart = ref(null);
const barChart = ref(null);
const wordCloudChart = ref(null);

let lineChartInstance = null;
let pieChartInstance = null;
let barChartInstance = null;
let wordCloudChartInstance = null;

const { proxy } = getCurrentInstance();

// æŠ˜çº¿å›¾é…ç½® - åœºåœ°ä½¿ç”¨ç‡è¶‹åŠ¿
const lineChartOption = ref({
    backgroundColor: 'transparent',
    grid: {
        top: '15%',
        left: '10%',
        right: '10%',
        bottom: '15%'
    },
    xAxis: {
        type: 'category',
        data: ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­', 'å‘¨æ—¥'],
        axisLine: {
            lineStyle: { color: '#00d4ff' }
        },
        axisLabel: {
            color: '#00d4ff'
        }
    },
    yAxis: {
        type: 'value',
        max: 100,
        axisLine: {
            lineStyle: { color: '#00d4ff' }
        },
        axisLabel: {
            color: '#00d4ff',
            formatter: '{value}%'
        },
        splitLine: {
            lineStyle: { color: 'rgba(0, 212, 255, 0.2)' }
        }
    },
    series: [{
        data: [75, 82, 78, 88, 85, 62, 58],
        type: 'line',
        smooth: true,
        symbol: 'circle',
        symbolSize: 8,
        lineStyle: {
            width: 3,
            color: {
                type: 'linear',
                x: 0, y: 0, x2: 1, y2: 0,
                colorStops: [{
                    offset: 0, color: '#2575fc'
                }, {
                    offset: 1, color: '#00d4ff'
                }]
            }
        },
        itemStyle: {
            color: '#00d4ff',
            shadowColor: '#00d4ff',
            shadowBlur: 10
        },
        areaStyle: {
            color: {
                type: 'linear',
                x: 0, y: 0, x2: 0, y2: 1,
                colorStops: [{
                    offset: 0, color: 'rgba(37, 117, 252, 0.3)'
                }, {
                    offset: 1, color: 'rgba(0, 212, 255, 0.1)'
                }]
            }
        }
    }]
});

// é¥¼å›¾é…ç½® - è¿åŠ¨é¡¹ç›®å‚ä¸å æ¯”
const pieChartOption = ref({
    backgroundColor: 'transparent',
    legend: {
        orient: 'vertical',
        left: '10%',
        top: '20%',
        textStyle: {
            color: '#00d4ff'
        }
    },
    series: [{
        type: 'pie',
        radius: ['40%', '70%'],
        center: ['60%', '50%'],
        data: [
            { name: 'ç¯®çƒ', value: 35 },
            { name: 'ç¾½æ¯›çƒ', value: 25 },
            { name: 'å¥èº«', value: 20 },
            { name: 'æ¸¸æ³³', value: 12 },
            { name: 'å…¶ä»–', value: 8 }
        ],
        emphasis: {
            itemStyle: {
                shadowBlur: 10,
                shadowOffsetX: 0,
                shadowColor: 'rgba(0, 0, 0, 0.5)'
            }
        },
        itemStyle: {
            borderRadius: 8,
            borderColor: '#fff',
            borderWidth: 2
        },
        label: {
            color: '#00d4ff',
            formatter: '{b}: {c}%'
        },
        color: ['#2575fc', '#6a11cb', '#00b42a', '#f53f3f', '#ff7d00']
    }]
});

// æŸ±çŠ¶å›¾é…ç½® - è¿åŠ¨é«˜å³°æ—¶æ®µ
const barChartOption = ref({
    backgroundColor: 'transparent',
    grid: {
        top: '15%',
        left: '15%',
        right: '10%',
        bottom: '20%'
    },
    xAxis: {
        type: 'category',
        data: ['6-8ç‚¹', '8-10ç‚¹', '10-12ç‚¹', '14-16ç‚¹', '16-18ç‚¹', '18-20ç‚¹', '20-22ç‚¹'],
        axisLine: {
            lineStyle: { color: '#00d4ff' }
        },
        axisLabel: {
            color: '#00d4ff',
            rotate: 45
        }
    },
    yAxis: {
        type: 'value',
        axisLine: {
            lineStyle: { color: '#00d4ff' }
        },
        axisLabel: {
            color: '#00d4ff'
        },
        splitLine: {
            lineStyle: { color: 'rgba(0, 212, 255, 0.2)' }
        }
    },
    series: [{
        data: [280, 150, 100, 180, 520, 480, 320],
        type: 'bar',
        barWidth: '60%',
        itemStyle: {
            color: {
                type: 'linear',
                x: 0, y: 0, x2: 0, y2: 1,
                colorStops: [{
                    offset: 0, color: '#00d4ff'
                }, {
                    offset: 1, color: '#2575fc'
                }]
            },
            borderRadius: [4, 4, 0, 0],
            shadowColor: '#2575fc',
            shadowBlur: 10,
            shadowOffsetY: 5
        }
    }]
});

// è¯äº‘å›¾é…ç½® - çƒ­é—¨è¿åŠ¨é¡¹ç›®å…³é”®è¯
const wordCloudOption = ref({
    backgroundColor: 'transparent',
    series: [{
        type: 'wordCloud',
        shape: 'circle',
        left: 'center',
        top: 'center',
        width: '100%',
        height: '100%',
        right: null,
        bottom: null,
        sizeRange: [14, 60],
        rotationRange: [-45, 45],
        rotationStep: 45,
        gridSize: 8,
        drawOutOfBound: false,
        layoutAnimation: true,
        textStyle: {
            fontFamily: 'Microsoft YaHei, sans-serif',
            fontWeight: 'bold',
            color: function () {
                const colors = [
                    '#2575fc', '#00d4ff', '#6a11cb', '#00b42a',
                    '#f53f3f', '#ff7d00', '#00d4ff', '#9254de'
                ];
                return colors[Math.floor(Math.random() * colors.length)];
            }
        },
        emphasis: {
            focus: 'self',
            textStyle: {
                textShadowBlur: 10,
                textShadowColor: '#00d4ff'
            }
        },
        data: [
            { name: 'ç¯®çƒ', value: 1500 },
            { name: 'ç¾½æ¯›çƒ', value: 1200 },
            { name: 'å¥èº«', value: 1100 },
            { name: 'æ¸¸æ³³', value: 1000 },
            { name: 'è·‘æ­¥', value: 950 },
            { name: 'è¶³çƒ', value: 900 },
            { name: 'ä¹’ä¹“çƒ', value: 850 },
            { name: 'ç‘œä¼½', value: 800 },
            { name: 'ç½‘çƒ', value: 750 },
            { name: 'æ’çƒ', value: 700 },
            { name: 'åŠ¨æ„Ÿå•è½¦', value: 650 },
            { name: 'åŠ›é‡è®­ç»ƒ', value: 600 },
            { name: 'æœ‰æ°§è¿åŠ¨', value: 550 },
            { name: 'å™¨æ¢°è®­ç»ƒ', value: 500 },
            { name: 'è‡ªç”±æ³³', value: 480 },
            { name: 'è›™æ³³', value: 450 },
            { name: 'è¶æ³³', value: 420 },
            { name: 'ä»°æ³³', value: 400 },
            { name: 'æ‹‰ä¼¸', value: 380 },
            { name: 'çƒ­èº«', value: 350 },
            { name: 'ä¸‰åˆ†çƒ', value: 320 },
            { name: 'æ‰£çƒ', value: 300 },
            { name: 'å‘çƒ', value: 280 },
            { name: 'æ¥çƒ', value: 260 },
            { name: 'ä¼ çƒ', value: 240 }
        ]
    }]
});

// åˆå§‹åŒ–å›¾è¡¨å‡½æ•°
const initCharts = () => {
    if (!lineChart.value || !pieChart.value || !barChart.value || !wordCloudChart.value) return;

    // åˆå§‹åŒ–æŠ˜çº¿å›¾
    lineChartInstance = proxy.$echarts.init(lineChart.value);
    lineChartInstance.setOption(lineChartOption.value);

    // åˆå§‹åŒ–é¥¼å›¾
    pieChartInstance = proxy.$echarts.init(pieChart.value);
    pieChartInstance.setOption(pieChartOption.value);

    // åˆå§‹åŒ–æŸ±çŠ¶å›¾
    barChartInstance = proxy.$echarts.init(barChart.value);
    barChartInstance.setOption(barChartOption.value);

    // åˆå§‹åŒ–è¯äº‘å›¾
    wordCloudChartInstance = proxy.$echarts.init(wordCloudChart.value);
    wordCloudChartInstance.setOption(wordCloudOption.value);
};

const handleTabSwitch = (tab) => {
    activeTab.value = tab;
    if (tab === 'data') {
        currentChart.value = 'line';
        nextTick(() => {
            initCharts();
        });
    }
};

const switchChart = (chartType) => {
    currentChart.value = chartType;
    nextTick(() => {
        if (chartType === 'line' && lineChartInstance) {
            lineChartInstance.resize();
        } else if (chartType === 'pie' && pieChartInstance) {
            pieChartInstance.resize();
        } else if (chartType === 'bar' && barChartInstance) {
            barChartInstance.resize();
        } else if (chartType === 'wordCloud' && wordCloudChartInstance) {
            wordCloudChartInstance.resize();
        }
    });
};

watch(() => props.show, (newVal) => {
    if (newVal && activeTab.value === 'data') {
        nextTick(() => {
            initCharts();
        });
    }
});

const closeModal = () => emit('close');
const navigateToGym = () => emit('navigate');

const openFullScreenData = () => {
    const fullScreenWindow = window.open('', '_blank', 'width=1920,height=1080');
    const fullScreenContent = `
    <!DOCTYPE html>
    <html lang="zh-CN">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>è¥¿å—äº¤é€šå¤§å­¦ä½“è‚²é¦† - æ•°æ®å¯è§†åŒ–å¤§å±</title>
        <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"><\/script>
        <script src="https://cdn.jsdelivr.net/npm/echarts-wordcloud@2.1.0/dist/echarts-wordcloud.min.js"><\/script>
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
    font-family: 'Microsoft YaHei', sans-serif;
    overflow: hidden;
    height: 100vh;
}

.fullscreen-container {
    width: 100vw;
    height: 100vh;
    padding: 15px;
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.header {
    text-align: center;
    color: #00d4ff;
    font-size: 28px;
    font-weight: bold;
    text-shadow: 0 0 20px rgba(0, 212, 255, 0.8);
    flex-shrink: 0;
}

.data-overview {
    display: flex;
    gap: 15px;
    height: 100px;
    flex-shrink: 0;
}

.data-card {
    flex: 1;
    background: linear-gradient(135deg, rgba(37, 117, 252, 0.2), rgba(106, 17, 203, 0.2));
    border: 2px solid rgba(37, 117, 252, 0.5);
    border-radius: 12px;
    padding: 12px;
    text-align: center;
    backdrop-filter: blur(10px);
    box-shadow: 0 8px 32px rgba(37, 117, 252, 0.3);
    display: flex;
    flex-direction: column;
    justify-content: center;
}

.data-title {
    color: #00d4ff;
    font-size: 14px;
    margin-bottom: 5px;
    text-shadow: 0 0 10px rgba(0, 212, 255, 0.6);
}

.data-value {
    color: #ffffff;
    font-size: 32px;
    font-weight: bold;
    text-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
}

.charts-area {
    flex: 1;
    min-height: 0;
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    grid-template-rows: repeat(2, 1fr);
    gap: 15px;
}

.chart-container {
    background: linear-gradient(135deg, rgba(26, 26, 46, 0.8), rgba(22, 33, 62, 0.8));
    border: 2px solid rgba(37, 117, 252, 0.4);
    border-radius: 12px;
    padding: 12px;
    backdrop-filter: blur(10px);
    display: flex;
    flex-direction: column;
    min-height: 0;
    overflow: hidden;
}

.chart-title {
    color: #00d4ff;
    font-size: 16px;
    text-align: center;
    margin-bottom: 8px;
    text-shadow: 0 0 10px rgba(0, 212, 255, 0.6);
    flex-shrink: 0;
}

.chart-canvas {
    flex: 1;
    min-height: 0;
    width: 100%;
    height: 100%;
}
</style>
</head>

<body>
    <div class="fullscreen-container">
        <div class="header">
            ğŸŸï¸ è¥¿å—äº¤é€šå¤§å­¦ä½“è‚²é¦† - æ•°æ®å¯è§†åŒ–å¤§å±
        </div>
        <div class="data-overview">
            <div class="data-card">
                <div class="data-title">ä»Šæ—¥è¿åŠ¨äººæ•°</div>
                <div class="data-value">${todayVisitors.value}</div>
            </div>
            <div class="data-card">
                <div class="data-title">å½“å‰åœ¨åœºäººæ•°</div>
                <div class="data-value">${currentVisitors.value}</div>
            </div>
            <div class="data-card">
                <div class="data-title">ä»Šæ—¥é¢„çº¦åœºæ¬¡</div>
                <div class="data-value">${todayBookings.value}</div>
            </div>
            <div class="data-card">
                <div class="data-title">åœºåœ°ä½¿ç”¨ç‡</div>
                <div class="data-value">${fieldUsage.value}%</div>
            </div>
        </div>
        <div class="charts-area">
            <div class="chart-container">
                <div class="chart-title">ğŸ“ˆ è¿‘7å¤©åœºåœ°ä½¿ç”¨ç‡è¶‹åŠ¿</div>
                <div id="lineChart" class="chart-canvas"></div>
            </div>
            <div class="chart-container">
                <div class="chart-title">ğŸ… è¿åŠ¨é¡¹ç›®å‚ä¸å æ¯”</div>
                <div id="pieChart" class="chart-canvas"></div>
            </div>
            <div class="chart-container">
                <div class="chart-title">â° æ¯æ—¥è¿åŠ¨é«˜å³°æ—¶æ®µ</div>
                <div id="barChart" class="chart-canvas"></div>
            </div>
            <div class="chart-container">
                <div class="chart-title">â˜ï¸ çƒ­é—¨è¿åŠ¨é¡¹ç›®å…³é”®è¯</div>
                <div id="wordCloudChart" class="chart-canvas"></div>
            </div>
        </div>
    </div>
    <script>
            window.onload = function() {
                const lineChart = echarts.init(document.getElementById('lineChart'));
                lineChart.setOption(${JSON.stringify(lineChartOption.value)});
                
                const pieChart = echarts.init(document.getElementById('pieChart'));
                pieChart.setOption(${JSON.stringify(pieChartOption.value)});
                
                const barChart = echarts.init(document.getElementById('barChart'));
                barChart.setOption(${JSON.stringify(barChartOption.value)});
                
                const wordCloudChart = echarts.init(document.getElementById('wordCloudChart'));
                wordCloudChart.setOption(${JSON.stringify(wordCloudOption.value)});
                
                window.addEventListener('resize', function() {
                    lineChart.resize();
                    pieChart.resize();
                    barChart.resize();
                    wordCloudChart.resize();
                });
            };
        <\/script>
</body>
</html>
`;
    fullScreenWindow.document.write(fullScreenContent);
    fullScreenWindow.document.close();
};
</script>

<style scoped>
.gym-modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.4);
    display: flex;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(2px);
    z-index: 11000;
}

.gym-modal {
    background: white;
    border-radius: 16px;
    width: 90%;
    max-width: 900px;
    max-height: 85vh;
    overflow-y: auto;
    position: relative;
    animation: slideIn 0.3s ease-out;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
}

@keyframes slideIn {
    from {
        opacity: 0;
        transform: translateY(20px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.modal-close {
    position: absolute;
    top: 16px;
    right: 16px;
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: #999;
    padding: 0;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10;
    transition: color 0.18s;
}

.modal-close:hover {
    color: #333;
}

.modal-header {
    padding: 24px 24px 16px;
    border-bottom: 2px solid #f0f0f0;
}

.modal-header h2 {
    margin: 0 0 16px 0;
    font-size: 22px;
    font-weight: 700;
    color: #333;
}

.tab-container {
    display: flex;
    border-radius: 8px;
    overflow: hidden;
    background: #f5f5f5;
    margin-top: 8px;
}

.tab-item {
    flex: 1;
    text-align: center;
    padding: 10px 0;
    font-size: 14px;
    font-weight: 600;
    color: #666;
    cursor: pointer;
    transition: all 0.2s;
}

.tab-item.active {
    background: #2575fc;
    color: white;
}

.tab-item:hover:not(.active) {
    background: #e9e9e9;
}

.modal-body {
    padding: 24px;
}

.info-section {
    margin-bottom: 20px;
}

.info-section:last-child {
    margin-bottom: 0;
}

.info-section h3 {
    margin: 0 0 12px 0;
    font-size: 14px;
    font-weight: 700;
    color: #2575fc;
    border-bottom: 2px solid #2575fc;
    padding-bottom: 6px;
}

.info-item {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
    font-size: 14px;
    color: #333;
}

.label {
    font-weight: 600;
    margin-right: 8px;
    color: #555;
}

.facilities-list {
    list-style: none;
    margin: 0;
    padding: 0;
}

.facilities-list li {
    padding: 8px 0;
    font-size: 14px;
    color: #555;
    border-bottom: 1px solid #f0f0f0;
}

.facilities-list li:last-child {
    border-bottom: none;
}

.info-section p {
    margin: 0;
    font-size: 13px;
    line-height: 1.6;
    color: #666;
}

.modal-footer {
    display: flex;
    gap: 12px;
    padding: 16px 24px;
    border-top: 1px solid #f0f0f0;
    background: #f9f9f9;
    border-radius: 0 0 16px 16px;
}

.btn {
    flex: 1;
    padding: 12px 16px;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.18s;
}

.btn-secondary {
    background: #e0e0e0;
    color: #333;
}

.btn-secondary:hover {
    background: #d0d0d0;
}

.btn-primary {
    background: linear-gradient(90deg, #2575fc, #0d47a1);
    color: white;
}

.btn-primary:hover {
    box-shadow: 0 4px 12px rgba(37, 117, 252, 0.3);
}

.btn-info {
    background: linear-gradient(90deg, #6a11cb, #2575fc);
    color: white;
}

.btn-info:hover {
    box-shadow: 0 4px 12px rgba(106, 17, 203, 0.3);
}

.gym-modal::-webkit-scrollbar {
    width: 6px;
}

.gym-modal::-webkit-scrollbar-track {
    background: #f0f0f0;
    border-radius: 3px;
}

.gym-modal::-webkit-scrollbar-thumb {
    background: #ccc;
    border-radius: 3px;
}

.gym-modal::-webkit-scrollbar-thumb:hover {
    background: #999;
}

.data-visual-section {
    display: flex;
    flex-direction: column;
    gap: 20px;
    background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
    border-radius: 12px;
    padding: 20px;
    margin: -24px;
    margin-top: 0;
}

.data-cards {
    display: flex;
    gap: 16px;
    flex-wrap: wrap;
}

.data-card {
    flex: 1;
    min-width: 160px;
    background: linear-gradient(135deg, rgba(37, 117, 252, 0.1), rgba(106, 17, 203, 0.1));
    border: 1px solid rgba(37, 117, 252, 0.3);
    border-radius: 12px;
    padding: 16px;
    box-shadow: 0 4px 15px rgba(37, 117, 252, 0.2);
    transition: transform 0.2s, box-shadow 0.2s;
    backdrop-filter: blur(10px);
}

.data-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(37, 117, 252, 0.4);
    border-color: rgba(37, 117, 252, 0.6);
}

.data-title {
    font-size: 14px;
    color: #00d4ff;
    margin-bottom: 8px;
    text-shadow: 0 0 5px rgba(0, 212, 255, 0.5);
}

.data-value {
    font-size: 28px;
    font-weight: 700;
    color: #ffffff;
    margin-bottom: 4px;
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
}

.data-trend {
    font-size: 12px;
}

.data-trend.up {
    color: #00ff88;
    text-shadow: 0 0 5px rgba(0, 255, 136, 0.5);
}

.data-trend.down {
    color: #ff4757;
    text-shadow: 0 0 5px rgba(255, 71, 87, 0.5);
}

.chart-tabs {
    display: flex;
    gap: 12px;
    margin-bottom: 20px;
    flex-wrap: wrap;
}

.chart-tab-btn {
    flex: 1;
    min-width: 120px;
    padding: 12px 16px;
    background: linear-gradient(135deg, rgba(37, 117, 252, 0.15), rgba(106, 17, 203, 0.15));
    border: 1px solid rgba(37, 117, 252, 0.3);
    border-radius: 10px;
    color: #00d4ff;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    text-shadow: 0 0 5px rgba(0, 212, 255, 0.3);
}

.chart-tab-btn:hover {
    background: linear-gradient(135deg, rgba(37, 117, 252, 0.25), rgba(106, 17, 203, 0.25));
    border-color: rgba(37, 117, 252, 0.6);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(37, 117, 252, 0.3);
}

.chart-tab-btn.active {
    background: linear-gradient(135deg, #2575fc, #6a11cb);
    border-color: #2575fc;
    color: white;
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
    box-shadow: 0 6px 20px rgba(37, 117, 252, 0.5);
}

.chart-tab-btn.active:hover {
    transform: translateY(-3px);
}

.charts-container {
    display: flex;
    flex-direction: column;
    min-height: 400px;
}

.chart-item {
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
    border-radius: 12px;
    padding: 0;
    box-shadow: 0 4px 15px rgba(37, 117, 252, 0.2);
    border: 1px solid rgba(37, 117, 252, 0.3);
    overflow: hidden;
    animation: chartFadeIn 0.3s ease-out;
}

@keyframes chartFadeIn {
    from {
        opacity: 0;
        transform: translateY(10px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.chart-item h4 {
    margin: 0 0 5px 0;
    font-size: 16px;
    color: #00d4ff;
    font-weight: 600;
    text-align: center;
    padding: 15px;
    background: rgba(0, 212, 255, 0.1);
    border-bottom: 1px solid rgba(0, 212, 255, 0.3);
    text-shadow: 0 0 8px rgba(0, 212, 255, 0.6);
}

.chart-canvas {
    width: 100%;
    height: 280px;
    background: transparent;
    padding: 15px;
}

@media (max-width: 768px) {
    .gym-modal {
        width: 95%;
        max-height: 90vh;
    }

    .modal-header h2 {
        font-size: 18px;
    }

    .data-cards {
        flex-direction: column;
    }

    .data-card {
        min-width: auto;
    }

    .modal-footer {
        flex-direction: column;
    }

    .chart-item {
        padding: 12px;
    }

    .chart-canvas {
        height: 200px;
    }

    .charts-container {
        gap: 15px;
    }

    .tab-item {
        font-size: 13px;
        padding: 8px 0;
    }
}
</style>
